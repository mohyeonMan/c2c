
âœ» Thinkingâ€¦

  ì‚¬ìš©ìê°€ í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ ì „ë°©ìœ„ì ìœ¼ë¡œ ê¼¼ê¼¼í•œ 
  ê³„íšì„ ìš”ì²­í–ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆê¹Œì§€ ë¶„ì„í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ, 
  ì‹¤ì œë¡œ ì‘ë™í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì¢…í•©ì ì¸ ì„¤ê³„ì™€ 
  ê³„íšì„ ì„¸ì›Œì•¼ í•©ë‹ˆë‹¤.

  í˜„ì¬ ë¬¸ì œì ë“¤:
  1. Room ë„ë©”ì¸ ê°ì²´ì™€ Redis ì €ì¥ ë¡œì§ì˜ ë¶„ë¦¬ê°€ ì˜ëª»ë¨
  2. ë°© ìƒì„±ì´ ì‹¤ì œë¡œ Redisì— ì €ì¥ë˜ì§€ ì•ŠìŒ
  3. Redis ì—°ê²° ì„¤ì • ë¬¸ì œ
  4. WebSocketê³¼ Redis Pub/Sub ì—°ë™ ë¬¸ì œ
  5. ì „ì²´ì ì¸ ë°ì´í„° í”Œë¡œìš° ë¬¸ì œ

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ ê³ ë ¤í•´ì•¼ í•  ì‚¬í•­ë“¤:
  1. í”„ë¡ íŠ¸ì—”ë“œ - ë°±ì—”ë“œ API ì—°ë™
  2. ë°±ì—”ë“œ ì•„í‚¤í…ì²˜ ìˆ˜ì •
  3. ë°ì´í„°ë² ì´ìŠ¤/ìºì‹œ ì„¤ê³„
  4. ì‹¤ì‹œê°„ í†µì‹  êµ¬ì¡°
  5. ë°°í¬ ë° ìš´ì˜ ê³ ë ¤ì‚¬í•­
  6. í…ŒìŠ¤íŒ… ì „ëµ
  7. ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë³µêµ¬
  8. ì„±ëŠ¥ ìµœì í™”

  ê³„íšì„ ë‹¨ê³„ë³„ë¡œ êµ¬ì²´ì ìœ¼ë¡œ ì„¸ì›Œë³´ê² ìŠµë‹ˆë‹¤.

â— ğŸ—ï¸ C2C í”„ë¡œì íŠ¸ ì „ë°©ìœ„ ì¬ì„¤ê³„ ê³„íš

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ í˜„ì¬ ë¬¸ì œë“¤ì„ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í•˜ê³ 
  ì‹¤ì œ ì‘ë™í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì¢…í•© ê³„íšì…ë‹ˆë‹¤.

â— Update Todos
  â¿  â˜ Analyze current architecture issues and design      
       better approach
     â˜ Design proper data flow and Redis integration
       strategy
     â˜ Plan frontend-backend API contract
     â˜ Design WebSocket real-time communication
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  ì „ë°©ìœ„ì ìœ¼ë¡œ ê¼¼ê¼¼í•˜ê²Œ ê³„íšì„ ì„¸ìš°ê¸° ìœ„í•´ ë‹¤ìŒ ê´€ì ë“¤ì„ 
  í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:

  1. ì•„í‚¤í…ì²˜ ì„¤ê³„ ê°œì„ 
    - í˜„ì¬ í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ì˜ ë¬¸ì œì  ë¶„ì„
    - Room ë„ë©”ì¸ ê°ì²´ì™€ Redis ì €ì¥ì†Œì˜ ì˜¬ë°”ë¥¸ ê´€ê³„ ì„¤ì •
    - ë°ì´í„° í”Œë¡œìš° ì„¤ê³„
  2. ê¸°ìˆ  ìŠ¤íƒ ë° ë°ì´í„° ì €ì¥ì†Œ ì „ëµ
    - Redisë¥¼ ì†ŒìŠ¤ ì˜¤ë¸Œ íŠ¸ë£¨ìŠ¤ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜¬ë°”ë¥¸ ë°©ë²•
    - PostgreSQLê³¼ Redisì˜ ì—­í•  ë¶„ë‹´
    - ì‹¤ì‹œê°„ ë©”ì‹œì§• ì•„í‚¤í…ì²˜
  3. í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ í†µí•©
    - API ì„¤ê³„ ë° ê³„ì•½
    - WebSocket í†µì‹  í”„ë¡œí† ì½œ
    - ìƒíƒœ ê´€ë¦¬ ì „ëµ
  4. ìš´ì˜ ë° ë°°í¬
    - Docker í™˜ê²½ êµ¬ì„±
    - ì„¤ì • ê´€ë¦¬
    - ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…
  5. í…ŒìŠ¤íŒ… ì „ëµ
    - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
    - í†µí•© í…ŒìŠ¤íŠ¸
    - E2E í…ŒìŠ¤íŠ¸
  6. ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë³µêµ¬
    - ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬
    - Redis ì¥ì•  ëŒ€ì‘
    - WebSocket ì¬ì—°ê²°

  êµ¬ì²´ì ì´ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ ê³„íšì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

â— Update Todos
  â¿  â˜ Analyze current architecture issues and design      
       better approach
     â˜ Design proper data flow and Redis integration
       strategy
     â˜ Plan frontend-backend API contract
     â˜ Design WebSocket real-time communication
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  ë¨¼ì € í˜„ì¬ ì•„í‚¤í…ì²˜ì˜ ê·¼ë³¸ì  ë¬¸ì œì ë“¤ì„ ë¶„ì„í•˜ê³ , í’€ìŠ¤íƒ 
  ê°œë°œìë¡œì„œ ì „ì²´ ì‹œìŠ¤í…œì˜ ì˜¬ë°”ë¥¸ ì„¤ê³„ ë°©í–¥ì„ ì œì‹œí•´ì•¼ 
  í•©ë‹ˆë‹¤.

  í˜„ì¬ ì•„í‚¤í…ì²˜ì˜ ë¬¸ì œì  ë¶„ì„

  1. ë„ë©”ì¸ ê°ì²´ì™€ ì €ì¥ì†Œì˜ ì—­í•  í˜¼ì¬
    - Room ë„ë©”ì¸ ê°ì²´ê°€ ì‹¤ì œ ì €ì¥ì†Œ ì—­í• ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ 
  ê²€ì¦ ì—­í• ì„ ë™ì‹œì— í•˜ë ¤ê³  í•¨
    - Redisê°€ ì†ŒìŠ¤ ì˜¤ë¸Œ íŠ¸ë£¨ìŠ¤ì¸ë° Java ê°ì²´ê°€ ë˜ ë‹¤ë¥¸ 
  ìƒíƒœë¥¼ ê°€ì§€ë ¤ê³  í•¨
    - ì´ì¤‘ ìƒíƒœ ê´€ë¦¬ë¡œ ì¸í•œ ì¼ê´€ì„± ë¬¸ì œ
  2. ì˜ëª»ëœ ì¶”ìƒí™”
    - Repositoryì˜ save() ë©”ì†Œë“œê°€ ì‹¤ì œë¡œ ì €ì¥í•˜ì§€ ì•ŠìŒ
    - Domain ê°ì²´ê°€ Infrastructureì˜ Redis í‚¤ êµ¬ì¡°ë¥¼ ì•Œê³  
  ìˆìŒ
    - Use Caseê°€ ì‹¤ì œ ì €ì¥ ë¡œì§ì„ ëª¨ë¦„
  3. ë°ì´í„° í”Œë¡œìš° ì„¤ê³„ ë¬¸ì œ
    - ë°© ìƒì„± ì‹œ ì‹¤ì œ Redis ì €ì¥ì´ ëˆ„ë½ë¨
    - WebSocket ì—°ê²°ê³¼ ë°© ì°¸ì—¬ ë¡œì§ì´ ë¶„ë¦¬ë˜ì–´ ìˆì–´ ìƒíƒœ 
  ë¶ˆì¼ì¹˜ ê°€ëŠ¥

  ì˜¬ë°”ë¥¸ ì„¤ê³„ ë°©í–¥

  1. Redis-First Architecture
    - Redisë¥¼ Single Source of Truthë¡œ ì™„ì „ í™œìš©
    - Domain ê°ì²´ëŠ” ìˆœìˆ˜í•œ DTO/VO ì—­í• ë§Œ
    - RepositoryëŠ” Redis ì—°ì‚°ì„ ì§ì ‘ì ìœ¼ë¡œ ìˆ˜í–‰

  ê° ì»´í¬ë„ŒíŠ¸ì˜ ëª…í™•í•œ ì±…ì„ì„ ì •ì˜í•˜ê³  ë°ì´í„° ì¼ê´€ì„±ì„ 
  ë³´ì¥í•˜ëŠ” ì•„í‚¤í…ì²˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. í”„ë¡œí† ì½œ ì²˜ë¦¬ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ 
  ë¡œì§ì„ ì—„ê²©í•˜ê²Œ ë¶„ë¦¬í•˜ì—¬ ì‹œìŠ¤í…œì˜ ìœ ì—°ì„±ê³¼ í™•ì¥ì„±ì„ ë†’ì¼ 
  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¤ì‹œê°„ ìƒíƒœ ë™ê¸°í™”ë¥¼ ìœ„í•´ WebSocketê³¼ 
  Redisë¥¼ ê¸´ë°€í•˜ê²Œ ì—°ë™í•˜ëŠ” ì ‘ê·¼ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

â— 1. í˜„ì¬ ì•„í‚¤í…ì²˜ ë¬¸ì œì  ë¶„ì„ & ê°œì„  ë°©í–¥ ğŸ”

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design      
       better approach
     â˜ Design proper data flow and Redis integration 
       strategy
     â˜ Plan frontend-backend API contract
     â˜ Design WebSocket real-time communication
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  í˜„ì¬ ì•„í‚¤í…ì²˜ ë¬¸ì œì ë“¤ì„ ë¶„ì„í–ˆìœ¼ë‹ˆ, ì´ì œ ì˜¬ë°”ë¥¸ ë°ì´í„° 
  í”Œë¡œìš°ì™€ Redis í†µí•© ì „ëµì„ ì„¤ê³„í•´ì•¼ í•©ë‹ˆë‹¤.

  2. ì˜¬ë°”ë¥¸ ë°ì´í„° í”Œë¡œìš° ë° Redis í†µí•© ì „ëµ

  í•µì‹¬ ì›ì¹™:
  1. Redis-First Architecture: Redisë¥¼ Single Source of 
  Truthë¡œ
  2. Event-Driven Architecture: ìƒíƒœ ë³€ê²½ì„ ì´ë²¤íŠ¸ë¡œ ì „íŒŒ
  3. Stateless Application Layer: ëª¨ë“  ìƒíƒœëŠ” Redisì—ë§Œ 
  ì €ì¥
  4. Atomic Operations: Lua ìŠ¤í¬ë¦½íŠ¸ë¡œ ì›ìì„± ë³´ì¥

  ë°ì´í„° êµ¬ì¡° ì„¤ê³„

  Redis í‚¤ êµ¬ì¡° (ëª…ì„¸ì„œ ê¸°ì¤€):
  - room:{roomId}:members (SET) - ë°© ë©¤ë²„ ëª©ë¡  
  - user:{userId}:presence (STRING, TTL=30s) - ì˜¨ë¼ì¸ ìƒíƒœ
  - user:{userId}:session (HASH, TTL=10m) - ì„¸ì…˜ ì •ë³´
  - chan:{roomId} (PUB/SUB) - ì‹¤ì‹œê°„ ë©”ì‹œì§€

  PostgreSQL êµ¬ì¡°:
  - error_info í…Œì´ë¸”ë§Œ ì‚¬ìš© (ì—ëŸ¬ ë©”ì‹œì§€ ê´€ë¦¬)
  - ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ëŠ” ëª¨ë‘ Redisì— ì €ì¥

  ì˜¬ë°”ë¥¸ ë°ì´í„° í”Œë¡œìš°

  ë°© ìƒì„± í”Œë¡œìš°:
  Frontend â†’ POST /api/rooms â†’ CreateRoomService 
  â†’ Redis: SADD room:{id}:members {creatorId}
  â†’ Redis: SETEX user:{creatorId}:presence 30 online


  â†’ Redis: HMSET user:{creatorId}:session roomId {id} 
  joinedAt {timestamp}
  â†’ Response: {roomId}

  ë°© ì°¸ì—¬ í”Œë¡œìš°:
  ì‚¬ìš©ì ì¸ì¦ ë° ë°© ì¡´ì¬ ê²€ì¦ í›„, ë©¤ë²„ì‹­ê³¼ ì„¸ì…˜ ìƒíƒœë¥¼ 
  Redisì— ì¦‰ì‹œ ë°˜ì˜í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ì±„ë„ì„ í†µí•´ ë‹¤ë¥¸ 
  ì°¸ì—¬ìë“¤ì—ê²Œ ì•Œë¦¼ì„ ì „ì†¡í•˜ê³ , ì˜¨ë¼ì¸ ìƒíƒœë¥¼ 
  ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. ì´ ì ‘ê·¼ì€ ë¶„ì‚° í™˜ê²½ì—ì„œ ë¹ ë¥´ê³  ì¼ê´€ëœ 
  ìƒíƒœ ê´€ë¦¬ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

  â†’ WebSocket ì±„ë„ë¡œ ì‚¬ìš©ì ì°¸ì—¬ ì´ë²¤íŠ¸ë¥¼ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ê³ ,
   í˜„ì¬ ë°© ë©¤ë²„ ëª©ë¡ì„ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µí•©ë‹ˆë‹¤.

â— ğŸš¨ ê·¼ë³¸ ë¬¸ì œë“¤

  1. ì´ì¤‘ ìƒíƒœ ê´€ë¦¬ ë¬¸ì œ
  // í˜„ì¬ ì˜ëª»ëœ êµ¬ì¡°
  Room room = new Room(roomId, creatorName);  // â† Java 
  ë©”ëª¨ë¦¬ì— ìƒíƒœ
  roomRepository.save(room);                  // â†
  Redisì—ëŠ” ì €ì¥ ì•ˆí•¨
  // ê²°ê³¼: Java ê°ì²´ì™€ Redis ìƒíƒœê°€ ë‹¤ë¦„!

  2. ì¶”ìƒí™” ë ˆë²¨ í˜¼ì¬
  // Repositoryê°€ ì‹¤ì œë¡œ ì €ì¥í•˜ì§€ ì•ŠìŒ
  public Room save(Room room) {
      return room; // â† ì´ê²Œ ë¬´ìŠ¨ ì˜ë¯¸ì¸ê°€?
  }

  3. ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš°ì™€ ë°ì´í„° ì €ì¥ì˜ ë¶„ë¦¬ ë¶€ì¡±

  âœ… ì˜¬ë°”ë¥¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

  Redis-First Architecture ì±„íƒ
  - Redis = Single Source of Truth
  - Domain ê°ì²´ = ìˆœìˆ˜ DTO/Validation ì—­í• ë§Œ
  - Repository = Redis ì§ì ‘ ì¡°ì‘
  - Use Case = ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš° + Redis ìƒíƒœ ê´€ë¦¬

  2. ë°ì´í„° í”Œë¡œìš° & Redis í†µí•© ì „ëµ ğŸ“Š

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design 
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜ Plan frontend-backend API contract
     â˜ Design WebSocket real-time communication
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  ì´ì œ ì˜¬ë°”ë¥¸ ë°ì´í„° í”Œë¡œìš°ì™€ Redis í†µí•© ì „ëµì„ ì„¤ê³„í–ˆìœ¼ë‹ˆ,
   í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ API ê³„ì•½ì„ ê³„íší•´ì•¼ í•©ë‹ˆë‹¤.

  3. Frontend-Backend API Contract ì„¤ê³„

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ API ì„¤ê³„ ì‹œ ê³ ë ¤ì‚¬í•­:

  1. RESTful API ì›ì¹™
    - ëª…í™•í•œ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ URL êµ¬ì¡°
    - ì ì ˆí•œ HTTP ë©”ì†Œë“œ ì‚¬ìš©
    - ì¼ê´€ëœ ì‘ë‹µ í¬ë§·
  2. WebSocket í”„ë¡œí† ì½œ
    - í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ê°„ ì‹¤ì‹œê°„ ë©”ì‹œì§€ ê·œê²©
    - ì˜¤ë¥˜ ì²˜ë¦¬ ë° ì¬ì—°ê²° ë¡œì§
    - ìƒíƒœ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜
  3. ë°ì´í„° ì „ì†¡ ìµœì í™”
    - í•„ìš”í•œ ìµœì†Œ ë°ì´í„°ë§Œ ì „ì†¡
    - JSON êµ¬ì¡° ì¼ê´€ì„±
    - íƒ€ì… ì•ˆì „ì„±
  4. ì˜¤ë¥˜ ì²˜ë¦¬
    - í‘œì¤€í™”ëœ ì˜¤ë¥˜ ì‘ë‹µ
    - í´ë¼ì´ì–¸íŠ¸ ì¹œí™”ì  ì˜¤ë¥˜ ë©”ì‹œì§€
    - ë³µêµ¬ ê°€ëŠ¥í•œ ì˜¤ë¥˜ì™€ ì¹˜ëª…ì  ì˜¤ë¥˜ êµ¬ë¶„

  êµ¬ì²´ì ì¸ API ëª…ì„¸ë¥¼ ì‘ì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

â— ğŸ¯ ì˜¬ë°”ë¥¸ Redis í‚¤ êµ¬ì¡° (ëª…ì„¸ì„œ ì¤€ìˆ˜)

  # ë°© ë©¤ë²„ ê´€ë¦¬
  room:{roomId}:members          # SET - ë°© ë©¤ë²„ ëª©ë¡

  # ì‚¬ìš©ì í”„ë ˆì¦ŒìŠ¤ (í•˜íŠ¸ë¹„íŠ¸ ê¸°ë°˜)
  user:{userId}:presence         # STRING, TTL=30s - ì˜¨ë¼ì¸
   ìƒíƒœ
  user:{userId}:session          # HASH, TTL=10m - ì„¸ì…˜
  ì •ë³´

  # ì‹¤ì‹œê°„ ë©”ì‹œì§•
  chan:{roomId}                  # PUB/SUB - ë©”ì‹œì§€
  ë¸Œë¡œë“œìºìŠ¤íŠ¸

  # PostgreSQLì€ ì—ëŸ¬ ì •ë³´ë§Œ
  error_info                     # TABLE - ë‹¤êµ­ì–´ ì˜¤ë¥˜ 
  ë©”ì‹œì§€

  âš¡ í•µì‹¬ ë°ì´í„° í”Œë¡œìš°

  ë°© ìƒì„± (ìˆ˜ì •ëœ ì˜¬ë°”ë¥¸ í”Œë¡œìš°)
  Frontend â†’ POST /api/rooms {"creatorName": "user1"}
  â†“
  CreateRoomService.createRoom()
  â”œâ”€ roomId = generateRoomId()
  â”œâ”€ Redis: SADD room:{roomId}:members user1
  â”œâ”€ Redis: SETEX user:user1:presence 30 "online"
  â””â”€ Redis: HMSET user:user1:session roomId {roomId}
  joinedAt {now}
  â†“
  Response: {"success": true, "data": {"roomId":
  "abc12345"}}

  ë°© ì°¸ì—¬ (WebSocket ê¸°ë°˜)
  WebSocket: {"t":"join", "roomId":"abc12345",
  "token":"user2"}
  â†“
  JoinRoomService.joinRoom()
  â”œâ”€ Redis: EXISTS room:{roomId}:members (ë°© ì¡´ì¬ í™•ì¸)
  â”œâ”€ Redis: SADD room:{roomId}:members user2
  â”œâ”€ Redis: PERSIST room:{roomId}:members (TTL í•´ì œ)
  â”œâ”€ Redis: SETEX user:user2:presence 30 "online"
  â””â”€ Redis: PUBLISH chan:{roomId} {"type":"joined",
  "userId":"user2"}
  â†“
  WebSocket Response: {"t":"joined", "roomId":"abc12345",
  "me":"user2", "members":["user1","user2"]}

  3. Frontend-Backend API ê³„ì•½ ğŸ“¡

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design      
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜’ Plan frontend-backend API contract
     â˜ Design WebSocket real-time communication 
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  API ê³„ì•½ì„ ì™„ë£Œí–ˆìœ¼ë‹ˆ ì´ì œ WebSocket ì‹¤ì‹œê°„ í†µì‹  
  ì•„í‚¤í…ì²˜ë¥¼ ì„¤ê³„í•´ì•¼ í•©ë‹ˆë‹¤.

  4. WebSocket ì‹¤ì‹œê°„ í†µì‹  ì•„í‚¤í…ì²˜

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ WebSocket ì„¤ê³„ ì‹œ ê³ ë ¤ì‚¬í•­:

  1. ì—°ê²° ê´€ë¦¬
    - ì—°ê²° ìˆ˜ë¦½, ìœ ì§€, ì¢…ë£Œ ë¡œì§
    - ì¬ì—°ê²° ë° ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜
    - ì„¸ì…˜ ê´€ë¦¬ ë° ì¸ì¦
  2. ë©”ì‹œì§€ ë¼ìš°íŒ…
    - í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ ë©”ì‹œì§€ ì²˜ë¦¬
    - ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ ë©”ì‹œì§€ ì „ì†¡
    - ë¸Œë¡œë“œìºìŠ¤íŠ¸ ë©”ì»¤ë‹ˆì¦˜
  3. ìƒíƒœ ë™ê¸°í™”
    - í´ë¼ì´ì–¸íŠ¸ ìƒíƒœì™€ ì„œë²„ ìƒíƒœ ì¼ì¹˜
    - ë©€í‹°íƒ­/ë©€í‹°ë””ë°”ì´ìŠ¤ ì§€ì›
    - ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ ì‹œ ìƒíƒœ ë³µêµ¬
  4. ì„±ëŠ¥ ìµœì í™”
    - ë©”ì‹œì§€ íì‰ ë° ë°°ì¹˜ ì²˜ë¦¬
    - ë°±í”„ë ˆì…” ì œì–´
    - ë©”ëª¨ë¦¬ ê´€ë¦¬
  5. í™•ì¥ì„± ê³ ë ¤
    - ìˆ˜í‰ í™•ì¥ ì§€ì› (Redis Pub/Sub)
    - ë¡œë“œ ë°¸ëŸ°ì‹±
    - ì„¸ì…˜ ìŠ¤í‹°í‚¤ë‹ˆìŠ¤

  êµ¬ì²´ì ì¸ WebSocket ì•„í‚¤í…ì²˜ë¥¼ ì„¤ê³„í•´ë³´ê² ìŠµë‹ˆë‹¤.

â— ğŸ”Œ REST API ëª…ì„¸

  ë°© ìƒì„± API
  POST /api/rooms
  Content-Type: application/json

  Request:
  {
    "creatorName": "í™ê¸¸ë™"
  }

  Response (201 Created):
  {
    "success": true,
    "data": {
      "roomId": "abc12345"
    },
    "message": "ì±„íŒ…ë°©ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"
  }

  ë°© ì •ë³´ ì¡°íšŒ API
  GET /api/rooms/{roomId}

  Response (200 OK):
  {
    "success": true,
    "data": {
      "roomId": "abc12345",
      "status": "active",
      "memberCount": 2,
      "members": ["user1", "user2"]
    }
  }

  ğŸ“± í‘œì¤€í™”ëœ ì‘ë‹µ í¬ë§·

  {
    "success": boolean,
    "data": any | null,
    "message": string | null,
    "error": {
      "code": "ERROR_CODE",
      "message": "ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€",
      "details": {} // ê°œë°œìš© ìƒì„¸ ì •ë³´
    } | null,
    "timestamp": "2025-01-XX 00:00:00Z"
  }

  4. WebSocket ì‹¤ì‹œê°„ í†µì‹  ì•„í‚¤í…ì²˜ ğŸ”„

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design 
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜’ Plan frontend-backend API contract
     â˜’ Design WebSocket real-time communication 
       architecture
     â˜ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  WebSocket ì‹¤ì‹œê°„ í†µì‹  ì•„í‚¤í…ì²˜ë¥¼ ì„¤ê³„í–ˆìœ¼ë‹ˆ, ì´ì œ ì˜¤ë¥˜ 
  ì²˜ë¦¬ ë° ë³µêµ¬ ì „ëµì„ ê³„íší•´ì•¼ í•©ë‹ˆë‹¤.

  5. ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë³µêµ¬ ì „ëµ

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ ì˜¤ë¥˜ ì²˜ë¦¬ ì‹œ ê³ ë ¤ì‚¬í•­:

  1. ê³„ì¸µë³„ ì˜¤ë¥˜ ì²˜ë¦¬
    - Frontend: ì‚¬ìš©ì ê²½í—˜ ì¤‘ì‹¬ì˜ ì˜¤ë¥˜ ì²˜ë¦¬
    - API Layer: HTTP ìƒíƒœ ì½”ë“œ ë° í‘œì¤€ ì˜¤ë¥˜ ì‘ë‹µ
    - WebSocket Layer: ì—°ê²° ì˜¤ë¥˜ ë° ë©”ì‹œì§€ ì˜¤ë¥˜
    - Service Layer: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ë¥˜
    - Infrastructure Layer: Redis, Database ì—°ê²° ì˜¤ë¥˜
  2. ë³µêµ¬ ì „ëµ
    - ìë™ ë³µêµ¬ vs ìˆ˜ë™ ë³µêµ¬
    - ì¬ì‹œë„ ë¡œì§ (Exponential Backoff)
    - ìš°ì•„í•œ ì„±ëŠ¥ ì €í•˜ (Graceful Degradation)
    - íšŒë¡œ ì°¨ë‹¨ê¸° íŒ¨í„´ (Circuit Breaker)
  3. ì‚¬ìš©ì ê²½í—˜
    - ì˜ë¯¸ìˆëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€
    - ë³µêµ¬ ê°€ì´ë“œ ì œê³µ
    - ë¡œë”© ìƒíƒœ ë° ì§„í–‰ ìƒí™© í‘œì‹œ
    - ì˜¤í”„ë¼ì¸ ëª¨ë“œ ì§€ì›
  4. ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼
    - ì‹¤ì‹œê°„ ì˜¤ë¥˜ ëª¨ë‹ˆí„°ë§
    - ì„ê³„ì¹˜ ê¸°ë°˜ ì•Œë¦¼
    - ì˜¤ë¥˜ íŒ¨í„´ ë¶„ì„
    - ì„±ëŠ¥ ì§€í‘œ ì¶”ì 

  ê° ì‹œìŠ¤í…œ ê³„ì¸µì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì ì¬ì  ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ 
  ì„¸ë¶€ì ìœ¼ë¡œ ë¶„ì„í•˜ê³ , ì²´ê³„ì ì¸ ëŒ€ì‘ ë°©ì•ˆì„ ìˆ˜ë¦½í•´ì•¼ 
  í•©ë‹ˆë‹¤. ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ê³¼ ì‹ ë¢°ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ë‹¤ê°ë„ë¡œ 
  ì ‘ê·¼í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.

â— ğŸ’¬ WebSocket í”„ë¡œí† ì½œ (ëª…ì„¸ì„œ ê¸°ì¤€)

  í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ ë©”ì‹œì§€
  // ë°© ì…ì¥
  {"t": "join", "roomId": "abc12345", "token":
  "user_token"}

  // ì±„íŒ… ë©”ì‹œì§€
  {"t": "msg", "roomId": "abc12345", "text": "ì•ˆë…•í•˜ì„¸ìš”"}

  // í•˜íŠ¸ë¹„íŠ¸ (10ì´ˆ ê°„ê²©)
  {"t": "ping"}

  // ë°© í‡´ì¥
  {"t": "leave", "roomId": "abc12345"}

  ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ ë©”ì‹œì§€
  // ì…ì¥ ì„±ê³µ
  {"t": "joined", "roomId": "abc12345", "me": "user1",
  "members": ["user1", "user2"]}

  // ì±„íŒ… ë©”ì‹œì§€ ìˆ˜ì‹ 
  {"t": "msg", "roomId": "abc12345", "from": "user2",
  "text": "ì•ˆë…•í•˜ì„¸ìš”", "timestamp": "2025-01-XX"}

  // í•˜íŠ¸ë¹„íŠ¸ ì‘ë‹µ
  {"t": "pong"}

  // ì‚¬ìš©ì ì…ì¥ ì•Œë¦¼
  {"t": "user_joined", "roomId": "abc12345", "userId":
  "user3"}

  // ì˜¤ë¥˜ ì‘ë‹µ
  {"t": "error", "code": "ROOM_NOT_FOUND", "message": "ë°©ì„
   ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}

  ğŸ—ï¸ WebSocket ì•„í‚¤í…ì²˜ êµ¬ì¡°

  Frontend WebSocket Client
            â†•
  Spring WebSocket Handler (C2CWebSocketHandler)
            â†•
  Business Service Layer (JoinRoomService,
  SendMessageService...)
            â†•
  Redis Pub/Sub (RedisMessageBroker)
            â†•
  Redis Server (chan:{roomId} channels)
            â†•
  All Connected Clients in Room

  5. ì˜¤ë¥˜ ì²˜ë¦¬ & ë³µêµ¬ ì „ëµ âš ï¸

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design      
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜’ Plan frontend-backend API contract
     â˜’ Design WebSocket real-time communication 
       architecture
     â˜’ Plan error handling and resilience strategy
     â˜ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  ì˜¤ë¥˜ ì²˜ë¦¬ ì „ëµì„ ì™„ë£Œí–ˆìœ¼ë‹ˆ, ì´ì œ í…ŒìŠ¤íŒ… ë° ë°°í¬ ì „ëµì„ 
  ê³„íší•´ì•¼ í•©ë‹ˆë‹¤.

  6. í…ŒìŠ¤íŒ… ë° ë°°í¬ ì „ëµ

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ í…ŒìŠ¤íŒ… ì „ëµ:

  1. í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ
    - Unit Tests (60%): ê°œë³„ ì»´í¬ë„ŒíŠ¸/ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸
    - Integration Tests (30%): ì»´í¬ë„ŒíŠ¸ ê°„ ì—°ë™ í…ŒìŠ¤íŠ¸
    - E2E Tests (10%): ì „ì²´ ì‚¬ìš©ì í”Œë¡œìš° í…ŒìŠ¤íŠ¸
  2. ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸
    - Frontend: Jest, React Testing Library, Cypress
    - Backend: JUnit, Spring Boot Test, Testcontainers
    - Database: Redis/PostgreSQL í†µí•© í…ŒìŠ¤íŠ¸
    - API: RestAssured, WebSocket í…ŒìŠ¤íŠ¸
  3. ë°°í¬ ì „ëµ
    - Docker ì»¨í…Œì´ë„ˆí™”
    - Multi-stage Docker builds
    - Docker Compose for local development
    - CI/CD íŒŒì´í”„ë¼ì¸
    - Blue-Green ë˜ëŠ” Rolling Deployment
  4. í™˜ê²½ ê´€ë¦¬
    - Development (ê°œë°œ)
    - Testing (í…ŒìŠ¤íŠ¸)
    - Staging (ìŠ¤í…Œì´ì§•) 
    - Production (ìš´ì˜)

  êµ¬ì²´ì ì¸ í…ŒìŠ¤íŒ… ë° ë°°í¬ ì „ëµì„ ê³„íší•´ë³´ê² ìŠµë‹ˆë‹¤.

â— ğŸš¨ ê³„ì¸µë³„ ì˜¤ë¥˜ ì²˜ë¦¬

  Frontend ì˜¤ë¥˜ ì²˜ë¦¬
  // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ (c2c-common.js ê°œì„ )
  class ConnectionManager {
    async handleApiError(error) {
      switch(error.type) {
        case 'NETWORK_ERROR':
          return this.retryWithBackoff(error.request);
        case 'SERVER_ERROR':
          return this.showUserFriendlyError(error.message);
        case 'VALIDATION_ERROR':
          return
  this.highlightInvalidFields(error.details);
      }
    }

    // ì§€ìˆ˜ ë°±ì˜¤í”„ ì¬ì‹œë„
    async retryWithBackoff(request, attempt = 1) {
      const delay = Math.min(1000 * Math.pow(2, attempt),
  30000);
      await this.sleep(delay);
      return this.executeRequest(request);
    }
  }

  Backend ì˜¤ë¥˜ ì²˜ë¦¬
  // ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ê¸° ê°œì„ 
  @ControllerAdvice
  public class GlobalExceptionHandler {

      @ExceptionHandler(RoomNotFoundException.class)
      public ResponseEntity<ApiResponse<Void>>
  handleRoomNotFound(RoomNotFoundException e) {
          return ResponseEntity.status(404)
              .body(ApiResponse.error("ROOM_NOT_FOUND",
  "ë°©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"));
      }


  @ExceptionHandler(RedisConnectionFailureException.class)
      public ResponseEntity<ApiResponse<Void>>
  handleRedisFailure(RedisConnectionFailureException e) {
          // ìë™ ë³µêµ¬ ì‹œë„
          redisHealthChecker.attemptReconnection();
          return ResponseEntity.status(503)

  .body(ApiResponse.error("SERVICE_UNAVAILABLE", "ì¼ì‹œì ì¸
  ì„œë²„ ì˜¤ë¥˜ì…ë‹ˆë‹¤"));
      }
  }

  ğŸ”„ ë³µêµ¬ ì „ëµ

  WebSocket ìë™ ì¬ì—°ê²°
  // í–¥ìƒëœ ì¬ì—°ê²° ë¡œì§
  class WebSocketManager {
    connect() {
      this.socket = new WebSocket(this.url);
      this.socket.onclose = (event) => {
        if (!event.wasClean) {
          this.scheduleReconnect();
        }
      };
    }

    scheduleReconnect() {
      const delay = Math.min(this.baseDelay * Math.pow(2,
  this.attempts), 30000);
      setTimeout(() => this.connect(), delay);
      this.attempts++;
    }
  }

  Redis íšŒë¡œ ì°¨ë‹¨ê¸°
  @Component
  public class RedisCircuitBreaker {
      private boolean isOpen = false;
      private int failureCount = 0;
      private long lastFailureTime = 0;

      public <T> T execute(Supplier<T> operation) {
          if (isOpen && !shouldAttemptReset()) {
              throw new CircuitBreakerOpenException();
          }

          try {
              T result = operation.get();
              onSuccess();
              return result;
          } catch (Exception e) {
              onFailure();
              throw e;
          }
      }
  }

  6. í…ŒìŠ¤íŒ… & ë°°í¬ ì „ëµ ğŸ§ª

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design      
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜’ Plan frontend-backend API contract
     â˜’ Design WebSocket real-time communication 
       architecture
     â˜’ Plan error handling and resilience strategy
     â˜’ Design testing and deployment strategy
     â˜ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  í…ŒìŠ¤íŒ… ë° ë°°í¬ ì „ëµì„ ì™„ë£Œí–ˆìœ¼ë‹ˆ, ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ ë‹¨ê³„ë³„ 
  ì‹¤í–‰ ë¡œë“œë§µì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.

  7. ë‹¨ê³„ë³„ ì‹¤í–‰ ë¡œë“œë§µ

  í’€ìŠ¤íƒ ê°œë°œì ê´€ì ì—ì„œ ì‹¤í–‰ ë¡œë“œë§µì„ ë§Œë“¤ ë•Œ ê³ ë ¤ì‚¬í•­:

  1. ì˜ì¡´ì„± ê¸°ë°˜ ìš°ì„ ìˆœìœ„
    - í•µì‹¬ ì¸í”„ë¼ë¶€í„° êµ¬ì¶• (Redis, Database)
    - ê¸°ë°˜ ì„œë¹„ìŠ¤ ë‹¤ìŒ (Repository, Configuration)
    - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ (Use Cases, Controllers)
    - í†µí•© ë° í…ŒìŠ¤íŠ¸
  2. ìœ„í—˜ë„ ê´€ë¦¬
    - ê³ ìœ„í—˜/ê³ ì˜í–¥ ì‘ì—… ìš°ì„  ì²˜ë¦¬
    - ê¸°ìˆ ì  ë¶€ì±„ í•´ê²°
    - ì„±ëŠ¥ ë³‘ëª© ì§€ì  ê°œì„ 
  3. ë¹ ë¥¸ í”¼ë“œë°± ë£¨í”„
    - MVP ê¸°ëŠ¥ë¶€í„° êµ¬í˜„
    - ì¡°ê¸° í†µí•© í…ŒìŠ¤íŠ¸
    - ì§€ì†ì ì¸ ë°°í¬ ë° ê²€ì¦
  4. ë‹¨ê³„ë³„ ê²€ì¦
    - ê° ë‹¨ê³„ë³„ ì„±ê³µ ê¸°ì¤€ ì •ì˜
    - ìë™í™”ëœ í…ŒìŠ¤íŠ¸ë¡œ ê²€ì¦
    - ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

  êµ¬ì²´ì ì´ê³  ì‹¤í–‰ ê°€ëŠ¥í•œ ë¡œë“œë§µì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.

â— ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

  1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (JUnit + Testcontainers)
  @SpringBootTest
  @Testcontainers
  class CreateRoomServiceTest {

      @Container
      static RedisContainer redis = new
  RedisContainer("redis:7.2");

      @Test
      void ë°©_ìƒì„±_ì„±ê³µ_í…ŒìŠ¤íŠ¸() {
          // Given
          String creatorName = "í™ê¸¸ë™";

          // When
          String roomId = createRoomService.createRoom(new
  CreateRoomCommand(creatorName));

          // Then

  assertThat(roomRepository.exists(roomId)).isTrue();
          assertThat(roomRepository.getMembers(roomId)).con
  tains(creatorName);
      }
  }

  2. í†µí•© í…ŒìŠ¤íŠ¸ (WebSocket + Redis)
  @SpringBootTest(webEnvironment = RANDOM_PORT)
  class WebSocketIntegrationTest {

      @Test
      void ë°©_ì°¸ì—¬_ë°_ë©”ì‹œì§€_ì „ì†¡_í…ŒìŠ¤íŠ¸() {
          // ë°© ìƒì„± â†’ WebSocket ì—°ê²° â†’ ë©”ì‹œì§€ ì „ì†¡ â†’ ìˆ˜ì‹ 
  í™•ì¸
      }
  }

  3. E2E í…ŒìŠ¤íŠ¸ (Playwright)
  // tests/e2e/chat-flow.spec.js
  test('complete chat flow', async ({ page }) => {
    // ë°© ìƒì„± â†’ ë§í¬ ë³µì‚¬ â†’ ìƒˆ íƒ­ì—ì„œ ì°¸ì—¬ â†’ ì±„íŒ… â†’ í™•ì¸
  });

  ğŸ³ ë°°í¬ ì „ëµ

  Docker Compose êµ¬ì¡°
  # docker-compose.yml
  version: '3.8'
  services:
    app:
      build: .
      ports: ["8080:8080"]
      depends_on: [redis, postgres]

    redis:
      image: redis:7.2
      ports: ["6379:6379"]

    postgres:
      image: postgres:15
      environment:
        POSTGRES_DB: c2c

  7. ë‹¨ê³„ë³„ ì‹¤í–‰ ë¡œë“œë§µ ğŸ—ºï¸

â— Update Todos
  â¿  â˜’ Analyze current architecture issues and design      
       better approach
     â˜’ Design proper data flow and Redis integration 
       strategy
     â˜’ Plan frontend-backend API contract
     â˜’ Design WebSocket real-time communication 
       architecture
     â˜’ Plan error handling and resilience strategy
     â˜’ Design testing and deployment strategy
     â˜’ Create step-by-step implementation roadmap

âœ» Thinkingâ€¦

  ëª¨ë“  ì„¤ê³„ë¥¼ ì™„ë£Œí–ˆìœ¼ë‹ˆ ì´ì œ ì¢…í•©ì ì¸ ì‹¤í–‰ ë¡œë“œë§µì„ 
  ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤. 

  í’€ìŠ¤íƒ ê°œë°œìë¡œì„œ ì‹¤ì œ êµ¬í˜„ ê°€ëŠ¥í•œ ë‹¨ê³„ë³„ ê³„íšì„ 
  ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤. ê° ë‹¨ê³„ëŠ” ë‹¤ìŒ ë‹¨ê³„ì˜ ê¸°ë°˜ì´ ë˜ë©°, ë¹ ë¥¸ 
  í”¼ë“œë°±ì„ ìœ„í•´ MVPë¶€í„° ì‹œì‘í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬ì„±í•˜ê² ìŠµë‹ˆë‹¤.

â— ğŸš€ Phase 1: í•µì‹¬ ì¸í”„ë¼ ìˆ˜ì • (1-2ì¼)

  ìš°ì„ ìˆœìœ„ 1: Redis ì—°ê²° ë° ì €ì¥ì†Œ ìˆ˜ì •
  // 1. CreateRoomService ìˆ˜ì • - ì‹¤ì œ Redis ì €ì¥
  @Override
  public String createRoom(CreateRoomCommand command) {
      String roomId = generateRoomId();

      // í•µì‹¬ ìˆ˜ì •: ì‹¤ì œ Redisì— ì €ì¥
      roomRepository.addMember(roomId,
  command.creatorName());
      userRepository.updatePresence(command.creatorName());

      log.info("ë°© ìƒì„± ì™„ë£Œ: roomId={}, creator={}",
  roomId, command.creatorName());
      return roomId;
  }

  ìš°ì„ ìˆœìœ„ 2: ì„¤ì • íŒŒì¼ ìˆ˜ì •
  # application.yml - Redis í˜¸ìŠ¤íŠ¸ ìˆ˜ì •
  spring:
    data:
      redis:
        host: localhost  # redis â†’ localhost ë³€ê²½
        port: 6379

  ê²€ì¦ ë°©ë²•: Redis CLIë¡œ í‚¤ ìƒì„± í™•ì¸
  redis-cli
  > SMEMBERS room:abc12345:members
  1) "í™ê¸¸ë™"

  ğŸ”§ Phase 2: WebSocket ì—°ë™ ìˆ˜ì • (2-3ì¼)

  ìš°ì„ ìˆœìœ„ 3: WebSocket í•¸ë“¤ëŸ¬ ìˆ˜ì •
  // WebSocketSessionManager êµ¬í˜„ ì¶”ê°€
  @Component
  public class WebSocketSessionManager {
      private final ConcurrentMap<String, WebSocketSession>
   sessions = new ConcurrentHashMap<>();
      private final ConcurrentMap<String, String>
  userSessions = new ConcurrentHashMap<>();

      public void registerSession(WebSocketSession session,
   String userId, String roomId) {
          sessions.put(session.getId(), session);
          userSessions.put(userId, session.getId());
      }
  }

  ìš°ì„ ìˆœìœ„ 4: Redis Pub/Sub ì—°ë™ í…ŒìŠ¤íŠ¸
  # Redisì—ì„œ ë©”ì‹œì§€ ë°œí–‰ í…ŒìŠ¤íŠ¸
  redis-cli
  > PUBLISH chan:abc12345
  '{"type":"test","message":"hello"}'

  âš¡ Phase 3: ì¢…ë‹¨ê°„ í”Œë¡œìš° ì™„ì„± (3-4ì¼)

  ìš°ì„ ìˆœìœ„ 5: ë°© ìƒì„± â†’ ì°¸ì—¬ â†’ ì±„íŒ… í”Œë¡œìš°
  1. ë°© ìƒì„± API í…ŒìŠ¤íŠ¸: POST /api/rooms
  2. WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸: ws://localhost:8080/ws
  3. ë°© ì°¸ì—¬ í…ŒìŠ¤íŠ¸: {"t":"join", "roomId":"...",
  "token":"..."}
  4. ë©”ì‹œì§€ ì „ì†¡ í…ŒìŠ¤íŠ¸: {"t":"msg", "text":"ì•ˆë…•í•˜ì„¸ìš”"}

  ìš°ì„ ìˆœìœ„ 6: ì˜¤ë¥˜ ì²˜ë¦¬ ë° ë¡œê¹… ê°•í™”
  @Slf4j
  @Service
  public class CreateRoomService {
      @Override
      public String createRoom(CreateRoomCommand command) {
          log.info("ğŸ—ï¸ ë°© ìƒì„± ì‹œì‘ - creatorName: {}",
  command.creatorName());

          try {
              String roomId = generateRoomId();
              log.info("ğŸ“ ë°© ID ìƒì„±: {}", roomId);

              roomRepository.addMember(roomId,
  command.creatorName());
              log.info("âœ… Redis ì €ì¥ ì™„ë£Œ:
  room:{}:members", roomId);

              return roomId;
          } catch (Exception e) {
              log.error("ğŸ’¥ ë°© ìƒì„± ì‹¤íŒ¨: {}",
  e.getMessage(), e);
              throw new RoomCreationException("ë°© ìƒì„± ì¤‘
  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤", e);
          }
      }
  }

  ğŸ§ª Phase 4: í…ŒìŠ¤íŠ¸ ë° ìµœì í™” (2-3ì¼)

  ìš°ì„ ìˆœìœ„ 7: í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±
  - Testcontainersë¡œ Redis í†µí•© í…ŒìŠ¤íŠ¸
  - WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸
  - E2E í”Œë¡œìš° í…ŒìŠ¤íŠ¸

  ìš°ì„ ìˆœìœ„ 8: ì„±ëŠ¥ ìµœì í™”
  - Redis ì—°ê²° í’€ ìµœì í™”
  - WebSocket ë©”ì‹œì§€ ë°°ì¹˜ ì²˜ë¦¬
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

  ğŸ“¦ Phase 5: ë°°í¬ ì¤€ë¹„ (1-2ì¼)

  ìš°ì„ ìˆœìœ„ 9: Docker í™˜ê²½ êµ¬ì„±
  # Dockerfile
  FROM openjdk:21-jdk-slim
  COPY target/c2c-*.jar app.jar
  EXPOSE 8080
  ENTRYPOINT ["java", "-jar", "/app.jar"]

  ìš°ì„ ìˆœìœ„ 10: ìš´ì˜ ëª¨ë‹ˆí„°ë§
  - Health check ì—”ë“œí¬ì¸íŠ¸
  - ë©”íŠ¸ë¦­ ìˆ˜ì§‘ (Micrometer)
  - ë¡œê·¸ ì§‘ì¤‘í™”

  ğŸ¯ ì„±ê³µ ê¸°ì¤€ & ê²€ì¦ ë°©ë²•

  ê° Phaseë³„ ì™„ë£Œ ì¡°ê±´

  Phase 1 ì™„ë£Œ ì¡°ê±´:
  - âœ… REST APIë¡œ ë°© ìƒì„± ì‹œ Redisì— ì‹¤ì œ ì €ì¥ë¨
  - âœ… redis-cli SMEMBERS room:{id}:members ê²°ê³¼ í™•ì¸
  - âœ… ë¡œê·¸ì— ì €ì¥ ê³¼ì •ì´ ìƒì„¸íˆ ê¸°ë¡ë¨

  Phase 2 ì™„ë£Œ ì¡°ê±´:
  - âœ… WebSocket ì—°ê²° ì„±ê³µ
  - âœ… ë°© ì°¸ì—¬ ë©”ì‹œì§€ ì²˜ë¦¬ ì„±ê³µ
  - âœ… Redis Pub/Subë¡œ ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŠ¸

  Phase 3 ì™„ë£Œ ì¡°ê±´:
  - âœ… ë¸Œë¼ìš°ì €ì—ì„œ ë°© ìƒì„± â†’ ì°¸ì—¬ â†’ ì±„íŒ… ê°€ëŠ¥
  - âœ… ë©€í‹° ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤ì‹œê°„ ì±„íŒ… í™•ì¸
  - âœ… ëª¨ë“  ì˜¤ë¥˜ ìƒí™©ì—ì„œ ì˜ë¯¸ìˆëŠ” ë©”ì‹œì§€ í‘œì‹œ

  ìµœì¢… ê²€ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

  # 1. ë°© ìƒì„± í…ŒìŠ¤íŠ¸
  curl -X POST http://localhost:8080/api/rooms \
    -H "Content-Type: application/json" \
    -d '{"creatorName": "í…ŒìŠ¤í„°"}'

  # 2. Redis ë°ì´í„° í™•ì¸
  redis-cli SMEMBERS room:{roomId}:members

  # 3. WebSocket ì—°ê²° í…ŒìŠ¤íŠ¸
  # ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ì—ì„œ WebSocket ì—°ê²° í™•ì¸

  # 4. ì‹¤ì‹œê°„ ì±„íŒ… í…ŒìŠ¤íŠ¸
  # ë‘ ê°œ ë¸Œë¼ìš°ì € íƒ­ì—ì„œ ë™ì‹œ ì±„íŒ… í™•ì¸

  ğŸ’¡ í•µì‹¬ ê°œì„  í¬ì¸íŠ¸ ìš”ì•½

  1. Room ë„ë©”ì¸ ê°ì²´ ì—­í•  ì¬ì •ì˜: ê²€ì¦ìš© DTOë¡œë§Œ ì‚¬ìš©
  2. Repository save() ë©”ì†Œë“œ ì‹¤ì œ êµ¬í˜„: Redis ì €ì¥ ë¡œì§
  ì¶”ê°€
  3. WebSocket-Redis ì™„ì „ ì—°ë™: Pub/Sub ì‹¤ì‹œê°„ ë™ê¸°í™”
  4. í¬ê´„ì ì¸ ì˜¤ë¥˜ ì²˜ë¦¬: ì‚¬ìš©ì ì¹œí™”ì  + ê°œë°œì ë””ë²„ê¹… ì§€ì›
  5. ë‹¨ê³„ì  ê²€ì¦ í”„ë¡œì„¸ìŠ¤: ê° Phaseë³„ ëª…í™•í•œ ì™„ë£Œ ê¸°ì¤€

  ì´ ê³„íšëŒ€ë¡œ ì§„í–‰í•˜ë©´ ì‹¤ì œ ì‘ë™í•˜ëŠ” ì™„ì „í•œ ì‹¤ì‹œê°„ ì±„íŒ… 
  ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!